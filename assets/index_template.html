<!doctype html>
<html>
<head>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <style>
    html, body {
      margin: 0;
      height: 100%;
    }

    .prototype-container {
      position: relative;
      height: 100%;
    }

    .artboard {
      position: absolute;
      left: 50%;
      top: 50%;
      opacity: 0;
      visibility: hidden;
      transform: translate(-50%, -50%);
      box-shadow: 0 0 0 1px rgba(0, 0, 0, .12);
    }

    .artboard.is-active {
      opacity: 1;
      visibility: visible;
    }

    .hotspot {
      cursor: pointer;
      position: absolute;
      opacity: 0;
      background-color: rgba(239, 108, 0, .2);
      box-shadow:
          0 0 0 3px rgba(239, 108, 0, .5) inset,
          0 4px 8px rgba(239, 108, 0, .25);
    }

    .highlight-hotspots .hotspot {
      animation: hotspotAnimation .6s ease;
    }

    @keyframes hotspotAnimation {
      0% {
        opacity: 0;
      }
      50% {
        opacity: 1;
      }
      100% {
        opacity: 0;
      }
    }
  </style>
</head>
<body>

  <div class="prototype-container">
  </div>

  <script>

    class Proto {
      constructor(configData) {
        this.configData = configData;
        this.buildUi();
      }

      buildUi() {
        Object.keys(this.configData.artboards).forEach(id => {
          let artboardData = this.configData.artboards[id];
          let $artboard = $('<div>')
              .addClass('artboard')
              .attr('data-artboard-id', id)
              .css({
                backgroundImage: `url(${id}.png)`,
                width: artboardData.width,
                height: artboardData.height,
              })
              .appendTo('.prototype-container');

          artboardData.hotspots.forEach(hotspotData => {
            let $hotspot = $('<div>')
              .addClass('hotspot')
              .attr('data-artboard-id', id)
              .css({
                left: hotspotData.rectangle.x,
                top: hotspotData.rectangle.y,
                width: hotspotData.rectangle.width,
                height: hotspotData.rectangle.height,
              })
              .appendTo($artboard);
            $hotspot.click(event => {
              this.gotoTarget(hotspotData.target)
              event.stopPropagation();
            });
          });
        });

        $(document).click(() => {
          $(document.body).removeClass('highlight-hotspots');
          let f = document.body.offsetWidth;
          $(document.body).addClass('highlight-hotspots');
        });

        this.gotoArtboard(this.configData.flowStartArtboardId);
      }

      gotoTarget(target) {
        if (target == 'back') {
          // TODO
          return;
        }

        this.gotoArtboard(target);
      }

      gotoArtboard(artboardId) {
        $('.artboard').removeClass('is-active');
        $(`.artboard[data-artboard-id="${artboardId}"]`).addClass('is-active');
      }
    }

    Proto.init = configData => new Proto(configData);

  </script>
  <script>
    Proto.init(/*###PROTOTYPEDATA###*/);
  </script>

</body>
</html>